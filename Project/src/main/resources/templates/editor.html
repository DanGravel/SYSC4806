<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>

    <script src="webjars/jquery/jquery.min.js"></script>
    <script src="webjars/momentjs/moment.js"></script>
    <script src="webjars/datatables/js/jquery.dataTables.min.js"></script>
    <script src="webjars/datatables/js/dataTables.bootstrap4.min.js"></script>
    <script src="webjars/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="webjars/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js"></script>
    <script src="/js/editor.js"></script>
    <link href="webjars/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet"/>
    <link href="webjars/datatables/css/dataTables.bootstrap4.min.css" rel="stylesheet">
    <link href="webjars/font-awesome/css/all.css" rel="stylesheet">
    <link href="webjars/bootstrap/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<header th:insert="header.html :: header"></header>
<br>
<table class="table table-bordered" id="editor_table">
    <thead class="thead-dark">
    <th>File Name</th>
    <th class="no-sort">Reviewer</th>
    <th class="no-sort">Date</th>
    <th>Status</th>
    <th class="no-sort">Accept/Reject</th>
    </thead>
    <tbody>
    <tr th:each="article: ${articles}" th:style="${article.isOnTime() ? '' : 'background-color: #FF6961'}">
        <td>
            <a th:href="@{/getfile/{id}(id=${article.id})}" th:text="${article.fileName}"></a>
        </td>
        <td>
            <form action="#" method="PATCH" th:action="@{/updateReviewer}">
                <input name="articleId" th:value=${article.id}/ type="hidden">
                <select class="form-control" name="reviewer" onchange="this.form.submit()">
                    <option th:text="${article.getReviewer() != null} ?
                                    ${article.getReviewer().username} :
                                    'Select a reviewer'"
                            value="0">
                    </option>
                    <option th:each="user : ${reviewers}" th:text="${user.username}" th:value=${user.id}></option>
                    <option value="-1">No Reviewer</option>
                </select>
            </form>
        </td>
        <td>
            <form action="#" id="date_form" method="PATCH" th:action="@{/updateDueDate}">
                <input name="articleId" th:value=${article.id}/ type="hidden">
                <div class="input-group mb-3">
                    <input class="form-control datetimepicker-input" data-toggle="datetimepicker" name="date"
                           th:attr="data-target='#datetimepicker' + ${article.id}" th:id="datetimepicker + ${article.id}"
                           th:placeholder="${article.getFormattedDueDate()}"
                           type="text"/>
                </div>
            </form>
        </td>
        <td>
            <a th:href="@{/review/{id}(id=${article.id})}" th:if="${article.hasReview()}"
               th:text="${article.state}"></a>
            <label th:text="${article.state}" th:unless="${article.hasReview()}"></label>
        </td>
        <td>
            <form action="#" class="d-inline" method="PATCH" th:action="@{/status}">
                <input name="articleId" th:value="${article.id}" type="hidden"/>
                <button class="btn btn-success" name="isAccepted" style="width: 175px" th:disabled="${!article.hasReview() || article.isAccepted()}" th:text="${article.hasReview()} ? 'Accept' : 'Waiting on Review'"
                        th:value="${true}"
                        type="submit"></button>
                <button class="btn btn-danger" name="isAccepted" style="width: 175px" th:disabled="${!article.hasReview() || article.isRejected()}" th:text="${article.hasReview()} ? 'Reject' : 'Waiting on Review'"
                        th:value="${false}"
                        type="submit"></button>
            </form>
        </td>
    </tr>
    </tbody>
</table>
</body>
</html>
